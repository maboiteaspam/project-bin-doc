<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>/home/maboiteaspam/Bureau/project-bin-doc/node_modules/github/generate.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/Cluc.html">Cluc</a></li>
                                <li><a href="../classes/ClucAnswer.html">ClucAnswer</a></li>
                                <li><a href="../classes/ClucChildProcess.html">ClucChildProcess</a></li>
                                <li><a href="../classes/ClucConfirm.html">ClucConfirm</a></li>
                                <li><a href="../classes/ClucContext.html">ClucContext</a></li>
                                <li><a href="../classes/.html"></a></li>
                                <li><a href="../classes/ClucDieOnError.html">ClucDieOnError</a></li>
                                <li><a href="../classes/ClucDisplay.html">ClucDisplay</a></li>
                                <li><a href="../classes/ClucMustNot.html">ClucMustNot</a></li>
                                <li><a href="../classes/ClucProgress.html">ClucProgress</a></li>
                                <li><a href="../classes/ClucRule.html">ClucRule</a></li>
                                <li><a href="../classes/ClucSpin.html">ClucSpin</a></li>
                                <li><a href="../classes/ClucSpinUntil.html">ClucSpinUntil</a></li>
                                <li><a href="../classes/ClucSsh.html">ClucSsh</a></li>
                                <li><a href="../classes/ClucSSHContext.html">ClucSSHContext</a></li>
                                <li><a href="../classes/ClucSuccess.html">ClucSuccess</a></li>
                                <li><a href="../classes/ClucWarn.html">ClucWarn</a></li>
                                <li><a href="../classes/ClucWatch.html">ClucWatch</a></li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: /home/maboiteaspam/Bureau/project-bin-doc/node_modules/github/generate.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
#!/usr/bin/env node
/** section: github, internal
 * class ApiGenerator
 *
 *  Copyright 2012 Cloud9 IDE, Inc.
 *
 *  This product includes software developed by
 *  Cloud9 IDE, Inc (http://c9.io).
 *
 *  Author: Mike de Boer &lt;mike@c9.io&gt;
 **/

&quot;use strict&quot;;

var Fs = require(&quot;fs&quot;);
var Path = require(&quot;path&quot;);

var Optimist = require(&quot;optimist&quot;);
var Util = require(&quot;./util&quot;);

var IndexTpl = Fs.readFileSync(__dirname + &quot;/templates/index.js.tpl&quot;, &quot;utf8&quot;);
var SectionTpl = Fs.readFileSync(__dirname + &quot;/templates/section.js.tpl&quot;, &quot;utf8&quot;);
var HandlerTpl = Fs.readFileSync(__dirname + &quot;/templates/handler.js.tpl&quot;, &quot;utf8&quot;);
var AfterRequestTpl = Fs.readFileSync(__dirname + &quot;/templates/after_request.js.tpl&quot;, &quot;utf8&quot;);
var TestSectionTpl = Fs.readFileSync(__dirname + &quot;/templates/test_section.js.tpl&quot;, &quot;utf8&quot;);
var TestHandlerTpl = Fs.readFileSync(__dirname + &quot;/templates/test_handler.js.tpl&quot;, &quot;utf8&quot;);

var main = module.exports = function(versions, tests, restore) {
    Util.log(&quot;Generating for versions&quot;, Object.keys(versions));

    Object.keys(versions).forEach(function(version) {
        var dir = Path.join(__dirname, &quot;api&quot;, version);

        // If we&#x27;re in restore mode, move .bak file back to their original position
        // and short-circuit.
        if (restore) {
            var bakRE = /\.bak$/;
            var files = Fs.readdirSync(dir).filter(function(file) {
                return bakRE.test(file);
            }).forEach(function(file) {
                var from = Path.join(dir, file);
                var to = Path.join(dir, file.replace(/\.bak$/, &quot;&quot;));
                Fs.renameSync(from, to);
                Util.log(&quot;Restored &#x27;&quot; + file + &quot;&#x27; (&quot; + version + &quot;)&quot;);
            });

            return;
        }


        var routes = versions[version];
        var defines = routes.defines;
        delete routes.defines;
        var headers = defines[&quot;response-headers&quot;];
        // cast header names to lowercase.
        if (headers &amp;&amp; headers.length)
            headers = headers.map(function(header) { return header.toLowerCase(); });
        var sections = {};
        var testSections = {};

        function createComment(paramsStruct, section, funcName, indent) {
            var params = Object.keys(paramsStruct);
            var comment = [
                indent + &quot;/** section: github&quot;,
                indent + &quot; *  &quot; + section + &quot;#&quot; + funcName + &quot;(msg, callback) -&gt; null&quot;,
                indent + &quot; *      - msg (Object): Object that contains the parameters and their values to be sent to the server.&quot;,
                indent + &quot; *      - callback (Function): function to call when the request is finished &quot; +
                    &quot;with an error as first argument and result data as second argument.&quot;,
                indent + &quot; *&quot;,
                indent + &quot; *  ##### Params on the &#x60;msg&#x60; object:&quot;,
                indent + &quot; *&quot;
            ];
            comment.push(indent + &quot; *  - headers (Object): Optional. Key/ value pair &quot;
                + &quot;of request headers to pass along with the HTTP request. Valid headers are: &quot;
                + &quot;&#x27;&quot; + defines[&quot;request-headers&quot;].join(&quot;&#x27;, &#x27;&quot;) + &quot;&#x27;.&quot;);
            if (!params.length)
                comment.push(indent + &quot; *  No other params, simply pass an empty Object literal &#x60;{}&#x60;&quot;);
            var paramName, def, line;
            for (var i = 0, l = params.length; i &lt; l; ++i) {
                paramName = params[i];
                if (paramName.charAt(0) == &quot;$&quot;) {
                    paramName = paramName.substr(1);
                    if (!defines.params[paramName]) {
                        Util.log(&quot;Invalid variable parameter name substitution; param &#x27;&quot; +
                            paramName + &quot;&#x27; not found in defines block&quot;, &quot;fatal&quot;);
                        process.exit(1);
                    }
                    else
                        def = defines.params[paramName];
                }
                else
                    def = paramsStruct[paramName];

                line = indent + &quot; *  - &quot; + paramName + &quot; (&quot; + (def.type || &quot;mixed&quot;) + &quot;): &quot; +
                    (def.required ? &quot;Required. &quot; : &quot;Optional. &quot;);
                if (def.description)
                    line += def.description;
                if (def.validation)
                    line += &quot; Validation rule: &#x60; &quot; + def.validation + &quot; &#x60;.&quot;;

                comment.push(line);
            }

            return comment.join(&quot;\n&quot;) + &quot;\n&quot; + indent + &quot; **/&quot;;
        }

        function getParams(paramsStruct, indent) {
            var params = Object.keys(paramsStruct);
            if (!params.length)
                return &quot;{}&quot;;
            var values = [];
            var paramName, def;
            for (var i = 0, l = params.length; i &lt; l; ++i) {
                paramName = params[i];
                if (paramName.charAt(0) == &quot;$&quot;) {
                    paramName = paramName.substr(1);
                    if (!defines.params[paramName]) {
                        Util.log(&quot;Invalid variable parameter name substitution; param &#x27;&quot; +
                            paramName + &quot;&#x27; not found in defines block&quot;, &quot;fatal&quot;);
                        process.exit(1);
                    }
                    else
                        def = defines.params[paramName];
                }
                else
                    def = paramsStruct[paramName];

                values.push(indent + &quot;    &quot; + paramName + &quot;: \&quot;&quot; + def.type + &quot;\&quot;&quot;);
            }
            return &quot;{\n&quot; + values.join(&quot;,\n&quot;) + &quot;\n&quot; + indent + &quot;}&quot;;
        }

        function prepareApi(struct, baseType) {
            if (!baseType)
                baseType = &quot;&quot;;

            Object.keys(struct).forEach(function(routePart) {
                var block = struct[routePart];
                if (!block)
                    return;
                var messageType = baseType + &quot;/&quot; + routePart;
                if (block.url &amp;&amp; block.params) {
                    // we ended up at an API definition part!
                    var parts = messageType.split(&quot;/&quot;);
                    var section = Util.toCamelCase(parts[1].toLowerCase());
                    if (!block.method) {
                        throw new Error(&quot;No HTTP method specified for &quot; + messageType +
                            &quot;in section &quot; + section);
                    }

                    parts.splice(0, 2);
                    var funcName = Util.toCamelCase(parts.join(&quot;-&quot;));
                    var comment = createComment(block.params, section, funcName, &quot;    &quot;);

                    // add the handler to the sections
                    if (!sections[section])
                        sections[section] = [];

                    var afterRequest = &quot;&quot;;
                    if (headers &amp;&amp; headers.length) {
                        afterRequest = AfterRequestTpl.replace(&quot;&lt;%headers%&gt;&quot;, &quot;\&quot;&quot; +
                            headers.join(&quot;\&quot;, \&quot;&quot;) + &quot;\&quot;&quot;);
                    }
                    sections[section].push(HandlerTpl
                        .replace(&quot;&lt;%funcName%&gt;&quot;, funcName)
                        .replace(&quot;&lt;%comment%&gt;&quot;, comment)
                        .replace(&quot;&lt;%afterRequest%&gt;&quot;, afterRequest)
                    );

                    // add test to the testSections
                    if (!testSections[section])
                        testSections[section] = [];
                    testSections[section].push(TestHandlerTpl
                        .replace(&quot;&lt;%name%&gt;&quot;, block.method + &quot; &quot; + block.url + &quot; (&quot; + funcName + &quot;)&quot;)
                        .replace(&quot;&lt;%funcName%&gt;&quot;, section + &quot;.&quot; + funcName)
                        .replace(&quot;&lt;%params%&gt;&quot;, getParams(block.params, &quot;            &quot;))
                    );
                }
                else {
                    // recurse into this block next:
                    prepareApi(block, messageType);
                }
            });
        }

        Util.log(&quot;Converting routes to functions&quot;);
        prepareApi(routes);

        Util.log(&quot;Writing files to version dir&quot;);
        var sectionNames = Object.keys(sections);

        Util.log(&quot;Writing index.js file for version &quot; + version);
        Fs.writeFileSync(Path.join(dir, &quot;index.js&quot;),
            IndexTpl
                .replace(&quot;&lt;%name%&gt;&quot;, defines.constants.name)
                .replace(&quot;&lt;%description%&gt;&quot;, defines.constants.description)
                .replace(&quot;&lt;%scripts%&gt;&quot;, &quot;\&quot;&quot; + sectionNames.join(&quot;\&quot;, \&quot;&quot;) + &quot;\&quot;&quot;),
            &quot;utf8&quot;);

        Object.keys(sections).forEach(function(section) {
            var def = sections[section];
            Util.log(&quot;Writing &#x27;&quot; + section + &quot;.js&#x27; file for version &quot; + version);
            Fs.writeFileSync(Path.join(dir, section + &quot;.js&quot;), SectionTpl
                .replace(/&lt;%sectionName%&gt;/g, section)
                .replace(&quot;&lt;%sectionBody%&gt;&quot;, def.join(&quot;\n&quot;)),
                &quot;utf8&quot;
            );

            // When we don&#x27;t need to generate tests, bail out here.
            if (!tests)
                return;

            def = testSections[section];
            // test if previous tests already contained implementations by checking
            // if the difference in character count between the current test file
            // and the newly generated one is more than twenty characters.
            var body = TestSectionTpl
                .replace(&quot;&lt;%version%&gt;&quot;, version.replace(&quot;v&quot;, &quot;&quot;))
                .replace(/&lt;%sectionName%&gt;/g, section)
                .replace(&quot;&lt;%testBody%&gt;&quot;, def.join(&quot;\n\n&quot;));
            var path = Path.join(dir, section + &quot;Test.js&quot;);
            if (Fs.existsSync(path) &amp;&amp; Math.abs(Fs.readFileSync(path, &quot;utf8&quot;).length - body.length) &gt;= 20) {
                Util.log(&quot;Moving old test file to &#x27;&quot; + path + &quot;.bak&#x27; to preserve tests &quot; +
                    &quot;that were already implemented. \nPlease be sure te check this file &quot; +
                    &quot;and move all implemented tests back into the newly generated test!&quot;, &quot;error&quot;);
                Fs.renameSync(path, path + &quot;.bak&quot;);
            }

            Util.log(&quot;Writing test file for &quot; + section + &quot;, version &quot; + version);
            Fs.writeFileSync(path, body, &quot;utf8&quot;);
        });
    });
};

if (!module.parent) {
    var argv = Optimist
      .wrap(80)
      .usage(&quot;Generate the implementation of the node-github module, including &quot;
           + &quot;unit-test scaffolds.\nUsage: $0 [-r] [-v VERSION]&quot;)
      .alias(&quot;r&quot;, &quot;restore&quot;)
      .describe(&quot;r&quot;, &quot;Restore .bak files, generated by a previous run, to the original&quot;)
      .alias(&quot;v&quot;, &quot;version&quot;)
      .describe(&quot;v&quot;, &quot;Semantic version number of the API to generate. Example: &#x27;3.0.0&#x27;&quot;)
      .alias(&quot;t&quot;, &quot;tests&quot;)
      .describe(&quot;t&quot;, &quot;Also generate unit test scaffolds&quot;)
      .alias(&quot;h&quot;, &quot;help&quot;)
      .describe(&quot;h&quot;, &quot;Display this usage information&quot;)
      .boolean([&quot;r&quot;, &quot;t&quot;, &quot;h&quot;])
      .argv;

    if (argv.help) {
        Util.log(Optimist.help());
        process.exit();
    }

    var baseDir = Path.join(__dirname, &quot;api&quot;);
    var availVersions = {};
    Fs.readdirSync(baseDir).forEach(function(version) {
        var path = Path.join(baseDir, version, &quot;routes.json&quot;);
        if (!Fs.existsSync(path))
            return;
        var routes;
        try {
            routes = JSON.parse(Fs.readFileSync(path, &quot;utf8&quot;));
        }
        catch (ex) {
            return;
        }
        if (!routes.defines)
            return;
        availVersions[version] = routes;
    });

    if (!Object.keys(availVersions).length) {
        Util.log(&quot;No versions available to generate.&quot;, &quot;fatal&quot;);
        process.exit(1);
    }
    var versions = {};
    if (argv.version) {
        if (argv.version.charAt(0) != &quot;v&quot;)
            argv.version = argv.v = &quot;v&quot; + argv.version;
        if (!availVersions[argv.version]) {
            Util.log(&quot;Version &#x27;&quot; + argv.version + &quot;&#x27; is not available&quot;, &quot;fatal&quot;);
            process.exit(1);
        }
        versions[argv.version] = availVersions[argv.version];
    }
    if (!Object.keys(versions).length) {
        Util.log(&quot;No versions specified via the command line, generating for all available versions.&quot;);
        versions = availVersions;
    }

    Util.log(&quot;Starting up...&quot;);
    main(versions, argv.tests, argv.restore);
}

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
